<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Quote {{ quote.id }} - Comparison</title>
  <style>
    {% include "styles/quote-base.css" %}
    
    /* Comparison template specific styles */
    .comparison-intro {
      background: var(--bg-light);
      padding: 16px 20px;
      border-radius: 8px;
      margin-bottom: 24px;
    }
    
    .comparison-intro h2 {
      font-size: 12pt;
      font-weight: 600;
      color: var(--text-primary);
      margin-bottom: 8px;
    }
    
    .comparison-intro p {
      font-size: 10pt;
      color: var(--text-secondary);
    }
    
    .comparison-table {
      width: 100%;
      border-collapse: collapse;
      margin-bottom: 24px;
      font-size: 10pt;
    }
    
    .comparison-table th {
      background: var(--primary-color);
      color: white;
      padding: 16px 12px;
      text-align: center;
      font-weight: 600;
    }
    
    .comparison-table th:first-child {
      background: var(--secondary-color);
      text-align: left;
      width: 30%;
    }
    
    .comparison-table td {
      padding: 12px;
      border-bottom: 1px solid var(--border-color);
      text-align: center;
    }
    
    .comparison-table td:first-child {
      text-align: left;
      font-weight: 500;
      background: var(--bg-light);
    }
    
    .comparison-table tr.feature-row td {
      font-size: 9pt;
    }
    
    .comparison-table .check {
      color: var(--success-color);
      font-weight: 700;
    }
    
    .comparison-table .cross {
      color: var(--text-muted);
    }
    
    .comparison-table .highlight {
      background: #dbeafe;
    }
    
    .comparison-table .highlight td:first-child {
      background: #bfdbfe;
    }
    
    .option-header {
      text-align: center;
    }
    
    .option-name {
      font-size: 12pt;
      font-weight: 700;
      display: block;
    }
    
    .option-subtitle {
      font-size: 9pt;
      opacity: 0.9;
      display: block;
      margin-top: 4px;
    }
    
    .price-cell {
      font-size: 14pt;
      font-weight: 700;
      color: var(--primary-color);
    }
    
    .price-period {
      font-size: 9pt;
      color: var(--text-muted);
      font-weight: 400;
    }
    
    .recommendation-badge {
      display: inline-block;
      background: var(--success-color);
      color: white;
      padding: 2px 8px;
      border-radius: 4px;
      font-size: 8pt;
      font-weight: 600;
      text-transform: uppercase;
      margin-bottom: 4px;
    }
    
    .comparison-summary {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 16px;
      margin-bottom: 24px;
    }
    
    .summary-card {
      border: 2px solid var(--border-color);
      border-radius: 8px;
      padding: 16px;
      text-align: center;
    }
    
    .summary-card.recommended {
      border-color: var(--success-color);
      background: #f0fdf4;
    }
    
    .summary-card h3 {
      font-size: 11pt;
      font-weight: 600;
      margin-bottom: 8px;
    }
    
    .summary-card .price {
      font-size: 18pt;
      font-weight: 700;
      color: var(--primary-color);
    }
    
    .summary-card .savings {
      font-size: 9pt;
      color: var(--success-color);
      margin-top: 4px;
    }
    
    .pros-cons {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 24px;
      margin-top: 24px;
    }
    
    .pros-cons h4 {
      font-size: 10pt;
      font-weight: 600;
      margin-bottom: 12px;
      padding-bottom: 8px;
      border-bottom: 1px solid var(--border-color);
    }
    
    .pros h4 {
      color: var(--success-color);
    }
    
    .cons h4 {
      color: var(--danger-color);
    }
    
    .pros-cons ul {
      list-style: none;
      margin: 0;
    }
    
    .pros-cons li {
      padding: 6px 0;
      font-size: 9pt;
      padding-left: 20px;
      position: relative;
    }
    
    .pros li::before {
      content: "✓";
      position: absolute;
      left: 0;
      color: var(--success-color);
      font-weight: 700;
    }
    
    .cons li::before {
      content: "×";
      position: absolute;
      left: 0;
      color: var(--danger-color);
      font-weight: 700;
    }
  </style>
</head>
<body>
  <!-- Header -->
  <header class="quote-header">
    <div class="company-branding">
      {% if company_logo %}
      <img src="{{ company_logo }}" alt="{{ company_name }}" class="company-logo">
      {% endif %}
      <div class="company-info">
        <h1>{{ company_name | default(value="Quotey") }}</h1>
        <p>Quote Comparison</p>
      </div>
    </div>
    <div class="quote-meta">
      <div class="quote-id">{{ quote.id }}</div>
      <span class="quote-status {{ quote.status | lower }}">{{ quote.status }}</span>
      <div class="quote-date">{{ quote.created_at | date(format="%B %d, %Y") }}</div>
    </div>
  </header>

  <!-- Customer Info -->
  <section class="customer-section">
    <div class="customer-info">
      <h2>Prepared For</h2>
      <div class="customer-name">{{ account.name }}</div>
      <div class="customer-contact">
        {% if primary_contact %}{{ primary_contact.name }}<br>{% endif %}
        Valid until {{ quote.valid_until | date(format="%B %d, %Y") }}
      </div>
    </div>
    <div class="quote-details">
      <h2>Quote Details</h2>
      <div class="detail-row">
        <span class="detail-label">Term</span>
        <span class="detail-value">{{ quote.term_months }} months</span>
      </div>
      <div class="detail-row">
        <span class="detail-label">Payment Terms</span>
        <span class="detail-value">{{ quote.payment_terms | default(value="Net 30") }}</span>
      </div>
    </div>
  </section>

  <!-- Comparison Intro -->
  <section class="comparison-intro">
    <h2>Compare Your Options</h2>
    <p>We've prepared {{ comparison_options | length | default(value=2) }} pricing options for your review. Each option is designed to meet different needs and budgets.</p>
  </section>

  <!-- Comparison Table -->
  {% if comparison_options %}
  <table class="comparison-table">
    <thead>
      <tr>
        <th>Features & Pricing</th>
        {% for option in comparison_options %}
        <th>
          <div class="option-header">
            {% if option.recommended %}<span class="recommendation-badge">Recommended</span>{% endif %}
            <span class="option-name">{{ option.name }}</span>
            {% if option.subtitle %}<span class="option-subtitle">{{ option.subtitle }}</span>{% endif %}
          </div>
        </th>
        {% endfor %}
      </tr>
    </thead>
    <tbody>
      <!-- Price Row -->
      <tr class="highlight">
        <td><strong>Total Price</strong></td>
        {% for option in comparison_options %}
        <td class="price-cell">
          {{ quote.currency | default(value="$") }}{{ "%.2f" | format(value=option.total_price) }}
          <span class="price-period">/ {{ quote.term_months }} mo</span>
        </td>
        {% endfor %}
      </tr>
      
      <!-- Monthly Row -->
      <tr>
        <td>Monthly Cost</td>
        {% for option in comparison_options %}
        <td>{{ quote.currency | default(value="$") }}{{ "%.2f" | format(value=option.total_price / (quote.term_months)) }}</td>
        {% endfor %}
      </tr>
      
      <!-- Products Included -->
      <tr class="feature-row">
        <td>Products Included</td>
        {% for option in comparison_options %}
        <td>{{ option.products | length }} items</td>
        {% endfor %}
      </tr>
      
      <!-- Feature Rows -->
      {% if comparison_features %}
        {% for feature in comparison_features %}
        <tr class="feature-row">
          <td>{{ feature.name }}</td>
          {% for option in comparison_options %}
          <td>
            {% if feature.values[loop.index0] %}
              {% if feature.values[loop.index0] == true %}
                <span class="check">✓</span>
              {% elif feature.values[loop.index0] == false %}
                <span class="cross">—</span>
              {% else %}
                {{ feature.values[loop.index0] }}
              {% endif %}
            {% else %}
              <span class="cross">—</span>
            {% endif %}
          </td>
          {% endfor %}
        </tr>
        {% endfor %}
      {% endif %}
      
      <!-- Support Level -->
      <tr class="feature-row">
        <td>Support Level</td>
        {% for option in comparison_options %}
        <td>{{ option.support_level | default(value="Standard") }}</td>
        {% endfor %}
      </tr>
    </tbody>
  </table>
  {% else %}
  <!-- Default 2-option comparison if no comparison_options provided -->
  <table class="comparison-table">
    <thead>
      <tr>
        <th>Features & Pricing</th>
        <th>
          <div class="option-header">
            <span class="option-name">Option A</span>
            <span class="option-subtitle">Standard Package</span>
          </div>
        </th>
        <th>
          <div class="option-header">
            <span class="recommendation-badge">Recommended</span>
            <span class="option-name">Option B</span>
            <span class="option-subtitle">Premium Package</span>
          </div>
        </th>
      </tr>
    </thead>
    <tbody>
      <tr class="highlight">
        <td><strong>Total Price</strong></td>
        <td class="price-cell">
          {{ quote.currency | default(value="$") }}{{ "%.2f" | format(value=pricing.total * 0.8) }}
          <span class="price-period">/ {{ quote.term_months }} mo</span>
        </td>
        <td class="price-cell">
          {{ quote.currency | default(value="$") }}{{ "%.2f" | format(value=pricing.total) }}
          <span class="price-period">/ {{ quote.term_months }} mo</span>
        </td>
      </tr>
      <tr>
        <td>Monthly Cost</td>
        <td>{{ quote.currency | default(value="$") }}{{ "%.2f" | format(value=pricing.total * 0.8 / (quote.term_months)) }}</td>
        <td>{{ quote.currency | default(value="$") }}{{ "%.2f" | format(value=pricing.total / (quote.term_months)) }}</td>
      </tr>
      <tr class="feature-row">
        <td>Products Included</td>
        <td>{{ lines | length }} items (Core)</td>
        <td>{{ lines | length }} items (Full)</td>
      </tr>
      <tr class="feature-row">
        <td>Support</td>
        <td>Business Hours</td>
        <td>24/7 Premium</td>
      </tr>
      <tr class="feature-row">
        <td>Implementation</td>
        <td>Self-Service</td>
        <td>Guided Onboarding</td>
      </tr>
      <tr class="feature-row">
        <td>SLA</td>
        <td>99.5% Uptime</td>
        <td>99.9% Uptime</td>
      </tr>
    </tbody>
  </table>
  {% endif %}

  <!-- Recommendation -->
  <section class="comparison-summary">
    {% if comparison_options %}
      {% for option in comparison_options %}
      <div class="summary-card {% if option.recommended %}recommended{% endif %}">
        <h3>{{ option.name }}</h3>
        <div class="price">{{ quote.currency | default(value="$") }}{{ "%.2f" | format(value=option.total_price) }}</div>
        {% if option.savings_vs_base %}
        <div class="savings">Save {{ quote.currency | default(value="$") }}{{ "%.2f" | format(value=option.savings_vs_base) }}</div>
        {% endif %}
      </div>
      {% endfor %}
    {% else %}
      <div class="summary-card">
        <h3>Option A</h3>
        <div class="price">{{ quote.currency | default(value="$") }}{{ "%.2f" | format(value=pricing.total * 0.8) }}</div>
      </div>
      <div class="summary-card recommended">
        <h3>Option B (Recommended)</h3>
        <div class="price">{{ quote.currency | default(value="$") }}{{ "%.2f" | format(value=pricing.total) }}</div>
        <div class="savings">Best value for your needs</div>
      </div>
      <div class="summary-card">
        <h3>Custom</h3>
        <div class="price">Contact Us</div>
      </div>
    {% endif %}
  </section>

  <!-- Terms -->
  <section class="terms-section">
    <h3>Next Steps</h3>
    <p>Please review the options above and let us know which package works best for your needs. We're happy to discuss any questions or customize a solution specific to your requirements.</p>
    <p style="margin-top: 12px;"><strong>Valid until:</strong> {{ quote.valid_until | date(format="%B %d, %Y") }}</p>
  </section>

  <!-- Footer -->
  <footer class="quote-footer">
    <p class="footer-text">
      Questions? Contact {{ sales_rep.name | default(value="your sales representative") }} at {{ sales_rep.email | default(value="sales@example.com") }}
    </p>
    {% if not white_label %}
    <p class="footer-text mt-1">Generated by Quotey</p>
    {% endif %}
  </footer>
</body>
</html>
