# Quotey PDF Templates

This directory contains HTML/CSS templates for generating PDF quotes. The templates use [Tera](https://keats.github.io/tera/) (a Jinja2-like template engine for Rust) for variable substitution.

## Template Structure

```
templates/
├── README.md                 # This file
├── styles/
│   └── quote-base.css       # Shared base styles for all templates
├── partials/                # Reusable template components
│   ├── header.html.tera     # Quote header with branding
│   ├── footer.html.tera     # Quote footer
│   ├── customer_info.html.tera  # Customer information section
│   ├── line_items.html.tera     # Line items table
│   └── totals.html.tera         # Pricing totals section
└── quotes/                  # Main quote templates
    ├── executive_summary.html.tera  # 1-page summary for executives
    ├── detailed.html.tera           # Full line items and details
    ├── comparison.html.tera         # Side-by-side option comparison
    ├── renewal.html.tera            # Contract renewal with changes
    └── compact.html.tera            # Minimal format for email
```

## Available Templates

### 1. Executive Summary (`executive_summary.html.tera`)
**Purpose:** One-page high-level overview for quick decision making.

**Best for:**
- Executive approvals
- Quick reviews
- High-level summaries

**Features:**
- Large total display
- Key metrics (product count, discount, monthly)
- Top products as chips
- Single page optimized

### 2. Detailed (`detailed.html.tera`)
**Purpose:** Complete quote with full line items and pricing breakdown.

**Best for:**
- Procurement departments
- Legal review
- Detailed audit trails

**Features:**
- Full line items table
- Pricing trace information
- Notes section
- Terms & conditions
- Approval section (if applicable)

### 3. Comparison (`comparison.html.tera`)
**Purpose:** Side-by-side comparison of multiple pricing options.

**Best for:**
- Presenting tier options
- Upsell scenarios
- Package comparisons

**Features:**
- Comparison table with features
- Recommended option highlighting
- Price per option
- Savings calculations

### 4. Renewal (`renewal.html.tera`)
**Purpose:** Contract renewal showing changes from previous contract.

**Best for:**
- Existing customer renewals
- Expansion deals
- Showing contract history

**Features:**
- Contract history summary
- Before/after comparison
- Change indicators (new, increased, decreased)
- Loyalty benefits section
- Renewal terms

### 5. Compact (`compact.html.tera`)
**Purpose:** Minimal format optimized for email attachment.

**Best for:**
- Email attachments
- Quick references
- Mobile viewing

**Features:**
- Minimal design
- Single page optimized
- Essential info only
- Clean typography

## Data Model

Templates expect the following data structure:

```json
{
  "quote": {
    "id": "Q-2026-0042",
    "status": "priced",
    "version": 1,
    "created_at": "2026-02-26T10:00:00Z",
    "valid_until": "2026-03-28T10:00:00Z",
    "term_months": 12,
    "start_date": "2026-03-01",
    "end_date": "2027-02-28",
    "payment_terms": "Net 30",
    "billing_frequency": "Annual",
    "currency": "$",
    "notes": "..."
  },
  "account": {
    "name": "Acme Corp",
    "industry": "Technology",
    "region": "US",
    "domain": "acme.com"
  },
  "primary_contact": {
    "name": "John Doe",
    "email": "john@acme.com"
  },
  "lines": [
    {
      "product_name": "Pro Plan",
      "description": "Enterprise software license",
      "quantity": 150,
      "unit_price": 10.00,
      "discount_pct": 10,
      "discount_amount": 150.00,
      "subtotal": 1350.00,
      "attributes": {"tier": "Enterprise"}
    }
  ],
  "pricing": {
    "subtotal": 20000.00,
    "discount_total": 2000.00,
    "tax_total": 0,
    "tax_rate": 0,
    "total": 18000.00
  },
  "sales_rep": {
    "name": "Jane Smith",
    "email": "jane@example.com"
  },
  "company_name": "Your Company",
  "company_logo": "data:image/png;base64,...",
  "white_label": false
}
```

## Customization

### Branding

Pass these variables to customize the appearance:

- `company_name` - Company name displayed in header
- `company_logo` - Base64-encoded logo image
- `company_address` - Company address
- `company_email` - Contact email
- `primary_color` - Main brand color (default: #2563eb)
- `secondary_color` - Secondary color (default: #1e40af)
- `accent_color` - Accent color (default: #3b82f6)

### White Label

Set `white_label: true` to remove "Generated by Quotey" footer.

## Usage in Rust

```rust
use tera::{Context, Tera};

// Load templates
let tera = Tera::new("templates/**/*").unwrap();

// Create context with data
let mut context = Context::new();
context.insert("quote", &quote);
context.insert("account", &account);
context.insert("lines", &lines);
context.insert("pricing", &pricing);

// Render template
let html = tera.render("quotes/detailed.html.tera", &context).unwrap();

// Convert to PDF using wkhtmltopdf or similar
```

## Styling Guidelines

### CSS Variables

Base styles use CSS custom properties for easy theming:

```css
:root {
  --primary-color: #2563eb;
  --secondary-color: #1e40af;
  --text-primary: #1f2937;
  --text-secondary: #6b7280;
  --border-color: #e5e7eb;
  --bg-light: #f9fafb;
}
```

### Print Optimization

All templates include print-specific styles:

```css
@media print {
  body {
    -webkit-print-color-adjust: exact;
    print-color-adjust: exact;
  }
}
```

### Page Breaks

Control page breaks with:

```css
.page-break { page-break-before: always; }
.page-break-avoid { page-break-inside: avoid; }
```

## Adding New Templates

1. Create a new `.html.tera` file in `templates/quotes/`
2. Include base styles: `{% include "styles/quote-base.css" %}`
3. Use partials where appropriate: `{% include "partials/header.html.tera" %}`
4. Add template-specific styles in a `<style>` block
5. Update this README with the new template

## Testing

Test templates with sample data:

```bash
# Using the CLI (when implemented)
quotey template preview --template detailed --quote Q-2026-0042

# Or generate a test PDF
quotey quote pdf Q-2026-0042 --template detailed --output test.pdf
```

## Template Development Tips

1. **Use Tera filters** for formatting:
   - `{{ amount | money }}` - Currency formatting
   - `{{ date | date(format="%B %d, %Y") }}` - Date formatting
   - `{{ lines | length }}` - Count items

2. **Conditional rendering**:
   ```html
   {% if pricing.discount_total > 0 %}
     <tr><td>Discount</td><td>{{ pricing.discount_total }}</td></tr>
   {% endif %}
   ```

3. **Loops with index**:
   ```html
   {% for line in lines %}
     <tr>
       <td>{{ loop.index }}</td>
       <td>{{ line.product_name }}</td>
     </tr>
   {% endfor %}
   ```

4. **Default values**:
   ```html
   {{ quote.currency | default(value="$") }}
   ```

## Related Documentation

- [Tera Documentation](https://keats.github.io/tera/docs/)
- [CSS Paged Media](https://developer.mozilla.org/en-US/docs/Web/CSS/@page)
- [wkhtmltopdf](https://wkhtmltopdf.org/)
